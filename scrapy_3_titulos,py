import requests
from bs4 import BeautifulSoup
import pandas as pd

url = "https://en.wikipedia.org/wiki/Python_(programming_language)"

headers = {"User-Agent": "Mozilla/5.0"}
response = requests.get(url, headers=headers)
html = response.text

soup = BeautifulSoup(html, "lxml")

# Tomamos solo el contenido principal
#content = soup.find("div", id="mw-content-text")

# Extraemos los títulos h2 y h3 (h1 es el título principal)
titles = [h.get_text(strip=True) for h in soup.find_all(["h1","h2", "h3"])]

df = pd.DataFrame(titles, columns=["Titulo"])
df.to_excel("titulos_python.xlsx", index=False)

print("Archivo 'titulos_python.xlsx' generado correctamente")
